<!-- templates/schedule/detail.html -->

{% extends 'base.html' %}
{% block content %}
<div class="container-fluid mt-4">
  <h2>äºˆå®šã®è©³ç´°</h2>
  <form method="POST">
    <div class="row">
      <!-- æ—¥ä»˜ (é–‹å§‹æ—¥ï½çµ‚äº†æ—¥ã§è¡¨ç¤º) -->
      <div class="col-12 col-md-6 mb-3">
         <label class="form-label">æ—¥ä»˜</label>
        <input type="text"
               class="form-control form-control-lg"
               disabled
               value="{% if schedule.end_date %}{{ schedule.date.strftime('%Y/%m/%d') }}ï½{{ schedule.end_date.strftime('%Y/%m/%d') }}{% else %}{{ schedule.date.strftime('%Y/%m/%d') }}{% endif %}">
       </div>
      <!-- æ™‚é–“å¸¯ -->
      <div class="col-12 col-md-6 mb-3">
        <label class="form-label">æ™‚é–“å¸¯</label>
        <select name="time_slot"
                class="form-control form-control-lg"
                {% if current_user.id != schedule.company_id and current_user.company_name != 'è±è¼é‡‘å‹å·¥æ¥­' %}disabled{% endif %}>
          {% for slot in ['åˆå‰','åˆå¾Œ','çµ‚æ—¥','å¤œ'] %}
            <option value="{{ slot }}" {% if schedule.time_slot == slot %}selected{% endif %}>
              {{ slot }}
            </option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="row">
      <!-- ä½œæ¥­å -->
      <div class="col-12 col-md-6 mb-3">
        <label class="form-label">ä½œæ¥­å</label>
        <input type="text" name="task_name" class="form-control form-control-lg" value="{{ schedule.task_name }}" {% if current_user.id != schedule.company_id and current_user.company_name != 'è±è¼é‡‘å‹å·¥æ¥­' %}disabled{% endif %}>
      </div>
      <!-- æ‹…å½“è€… -->
      <div class="col-12 col-md-6 mb-3">
        <label class="form-label">æ‹…å½“è€…</label>
        <input type="text" name="person_in_charge" class="form-control form-control-lg" value="{{ schedule.person_in_charge }}" {% if current_user.id != schedule.company_id and current_user.company_name != 'è±è¼é‡‘å‹å·¥æ¥­' %}disabled{% endif %}>
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">ä½œæ¥­ã‚³ãƒ¡ãƒ³ãƒˆ</label>
      <textarea name="comment" class="form-control form-control-lg" rows="3" {% if current_user.id != schedule.company_id and current_user.company_name != 'è±è¼é‡‘å‹å·¥æ¥­' %}disabled{% endif %}>{{ schedule.comment }}</textarea>
    </div>

    {# ä¾é ¼å…ƒã‚³ãƒ¡ãƒ³ãƒˆï¼šè±è¼é‡‘å‹å·¥æ¥­ã®ã¿ç·¨é›†å¯ã€ä»–ç¤¾ã¯è¡¨ç¤ºã®ã¿ #}
    {% if current_user.company_name == 'è±è¼é‡‘å‹å·¥æ¥­' %}
      <div class="mb-3">
        <label class="form-label">è±è¼é‡‘å‹å·¥æ¥­æ§˜ æ‹…å½“è€…</label>
        <input type="text" name="client_person" class="form-control form-control-lg" value="{{ schedule.client_person or '' }}">
      </div>
      <div class="mb-3">
        <label class="form-label">ä¾é ¼å…ƒã‚³ãƒ¡ãƒ³ãƒˆï¼ˆè±è¼é‡‘å‹æ§˜ï¼‰</label>
        <textarea name="client_comment" class="form-control form-control-lg" rows="3">{{ schedule.client_comment or '' }}</textarea>
      </div>
    {% else %}
      {% if schedule.client_comment or schedule.client_person %}
        <div class="alert alert-secondary mb-3">
          <p class="mb-1"><strong>ğŸ“ è±è¼é‡‘å‹å·¥æ¥­æ§˜ã‚³ãƒ¡ãƒ³ãƒˆï¼š</strong>{{ schedule.client_comment or 'ï¼ˆãªã—ï¼‰' }}</p>
          <p class="mb-0"><small>ğŸ‘¤ ã”æ‹…å½“è€…ï¼š{{ schedule.client_person or 'ï¼ˆæœªè¨˜å…¥ï¼‰' }}</small></p>
        </div>
      {% endif %}
    {% endif %}

    <div class="text-center mt-4">
      {% if current_user.id == schedule.company_id or current_user.company_name == 'è±è¼é‡‘å‹å·¥æ¥­' %}
        <button type="submit" class="btn btn-primary btn-lg w-100">ä¿å­˜</button>
      {% endif %}
    </div>
  </form>
</div>
{% endblock %}
