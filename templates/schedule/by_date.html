<!-- templates/schedule/by_date.html -->


{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h3>{{ selected_date.strftime('%Yå¹´%mæœˆ%dæ—¥') }} ã®å·¥ç¨‹äºˆå®š</h3>

  <form method="POST">
    {% for s in schedules %}
    <div class="card my-3">
      <div class="card-body">
        <h5 class="card-title">{{ s.company.company_name }}</h5>

        <div class="mb-2">
          <strong>æ‹…å½“è€…:</strong>
          {% if s.company_id == current_user.id %}
            <input type="text" name="person_in_charge_{{ s.id }}" value="{{ s.person_in_charge }}" class="form-control">
          {% else %}
            {{ s.person_in_charge or "æœªè¨­å®š" }}
          {% endif %}
        </div>

        <div class="mb-2">
          <strong>æ™‚é–“å¸¯:</strong>
          {% if s.company_id == current_user.id %}
            <select name="time_slot_{{ s.id }}" class="form-control">
              {% for slot in ['åˆå‰', 'åˆå¾Œ', 'çµ‚æ—¥', 'å¤œ'] %}
              <option value="{{ slot }}" {% if slot == s.time_slot %}selected{% endif %}>{{ slot }}</option>
              {% endfor %}
            </select>
          {% else %}
            {{ s.time_slot }}
          {% endif %}
        </div>

        <div class="mb-2">
          <strong>ä½œæ¥­å†…å®¹:</strong>
          {% if s.company_id == current_user.id %}
            <input type="text" name="task_name_{{ s.id }}" value="{{ s.task_name }}" class="form-control">
          {% else %}
            {{ s.task_name }}
          {% endif %}
        </div>

        <div class="mb-2">
          <strong>ã‚³ãƒ¡ãƒ³ãƒˆ:</strong>
          {% if s.company_id == current_user.id %}
            <textarea name="comment_{{ s.id }}" class="form-control" rows="2">{{ s.comment }}</textarea>
          {% else %}
            {{ s.comment or "ãªã—" }}
          {% endif %}
        </div>

        <!-- âœ… ä¾é ¼å…ƒæƒ…å ±ã‚‚ã‚«ãƒ¼ãƒ‰å†…ã«ç§»å‹• -->
<!-- ä¾é ¼å…ƒæ‹…å½“è€… -->
<div class="mb-2">
  <label>ä¾é ¼å…ƒæ‹…å½“è€…:</label>
  {% if current_user.company_name == s.company.company_name %}
    <input type="text" name="client_person_{{ s.id }}" value="{{ s.client_person or '' }}" class="form-control">
  {% else %}
    <input type="text" value="{{ s.client_person or 'æœªè¨­å®š' }}" class="form-control bg-light" readonly>
  {% endif %}
</div>

<!-- ä¾é ¼å…ƒã‚³ãƒ¡ãƒ³ãƒˆ -->
<div class="mb-2">
  <label>ä¾é ¼å…ƒã‚³ãƒ¡ãƒ³ãƒˆ:</label>
  {% if current_user.company_name == s.company.company_name %}
    <textarea name="client_comment_{{ s.id }}" class="form-control" rows="2">{{ s.client_comment or '' }}</textarea>
  {% else %}
    <textarea class="form-control bg-light" rows="2" readonly>{{ s.client_comment or 'ãªã—' }}</textarea>
  {% endif %}
</div>



      </div>
    </div>
    {% endfor %}

    <div class="text-center mt-4">
      <button type="submit" class="btn btn-primary">æ›´æ–°</button>
      <a href="{{ url_for('main.schedule_calendar') }}" class="btn btn-secondary">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«æˆ»ã‚‹</a>
    </div>
  </form>
</div>

<h4>ğŸ”° æ–°ã—ã„å·¥ç¨‹äºˆå®šã‚’è¿½åŠ </h4>
<form method="POST" action="{{ url_for('main.schedule_add', date=selected_date) }}">
  <div class="mb-3">
    <label>æ™‚é–“å¸¯</label>
    <select name="time_slot" class="form-control">
      {% for slot in ['åˆå‰', 'åˆå¾Œ', 'çµ‚æ—¥', 'å¤œ'] %}
      <option value="{{ slot }}">{{ slot }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="mb-3">
    <label>ä½œæ¥­å†…å®¹</label>
    <input type="text" name="task_name" class="form-control" required>
  </div>
  <div class="mb-3">
    <label>æ‹…å½“è€…</label>
    <input type="text" name="person_in_charge" class="form-control" required>
  </div>
  <div class="mb-3">
    <label>ã‚³ãƒ¡ãƒ³ãƒˆ</label>
    <textarea name="comment" class="form-control" rows="2"></textarea>
  </div>
   <div class="mb-3">
  <label for="site_name">ç¾å ´å</label>
  <input type="text" class="form-control" name="site_name" required>
</div>
  <button type="submit" class="btn btn-success">è¿½åŠ </button>
 

</form>

{% endblock %}
